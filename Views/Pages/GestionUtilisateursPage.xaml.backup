<Page x:Class="BacklogManager.Views.Pages.GestionUtilisateursPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Background="Transparent">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Liste utilisateurs moderne avec scroll -->
        <Border Grid.Row="1" Background="White" CornerRadius="12" BorderThickness="0" Margin="0,90,0,0">
            <Border.Effect>
                <DropShadowEffect Color="#E0E0E0" BlurRadius="12" ShadowDepth="2" Opacity="0.2" Direction="270"/>
            </Border.Effect>
            <ScrollViewer VerticalScrollBarVisibility="Auto" Margin="20">
                <DataGrid x:Name="LstUtilisateurs" AutoGenerateColumns="False" 
                          IsReadOnly="True" CanUserAddRows="False" SelectionMode="Single"
                          HeadersVisibility="Column" GridLinesVisibility="None"
                          BorderThickness="0" RowHeight="50"
                          AlternatingRowBackground="#FAFAFA" RowBackground="White"
                          VerticalScrollBarVisibility="Disabled">
                <DataGrid.ColumnHeaderStyle>
                    <Style TargetType="DataGridColumnHeader">
                        <Setter Property="Background" Value="#F5F5F5"/>
                        <Setter Property="Foreground" Value="#1A1919"/>
                        <Setter Property="FontWeight" Value="Bold"/>
                        <Setter Property="FontSize" Value="13"/>
                        <Setter Property="Padding" Value="15,12"/>
                        <Setter Property="BorderThickness" Value="0,0,0,2"/>
                        <Setter Property="BorderBrush" Value="#E0E0E0"/>
                    </Style>
                </DataGrid.ColumnHeaderStyle>
                <DataGrid.CellStyle>
                    <Style TargetType="DataGridCell">
                        <Setter Property="BorderThickness" Value="0"/>
                        <Setter Property="Padding" Value="15,10"/>
                        <Setter Property="FontSize" Value="13"/>
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="DataGridCell">
                                    <Border Padding="{TemplateBinding Padding}" Background="{TemplateBinding Background}">
                                        <ContentPresenter VerticalAlignment="Center"/>
                                    </Border>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </DataGrid.CellStyle>
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Nom complet" Binding="{Binding Utilisateur.NomComplet}" Width="2*"/>
                    <DataGridTextColumn Header="Username Windows" Binding="{Binding Utilisateur.UsernameWindows}" Width="1.5*"/>
                    <DataGridTextColumn Header="RÃ´le" Binding="{Binding RoleNom}" Width="1.5*"/>
                    <DataGridTemplateColumn Header="Statut" Width="1.2*">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Border Background="{Binding Utilisateur.StatutCouleurBadge}" 
                                        CornerRadius="12" Padding="10,4" HorizontalAlignment="Left">
                                    <TextBlock Text="{Binding Utilisateur.Statut}" 
                                               Foreground="White" FontSize="11" FontWeight="Bold"/>
                                </Border>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <DataGridTemplateColumn Header="Actif" Width="0.8*">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Border CornerRadius="12" Padding="10,4" HorizontalAlignment="Center">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Setter Property="Background" Value="#4CAF50"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Utilisateur.Actif}" Value="False">
                                                    <Setter Property="Background" Value="#9E9E9E"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <TextBlock FontSize="11" FontWeight="Bold" Foreground="White">
                                        <TextBlock.Style>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Text" Value="Oui"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding Utilisateur.Actif}" Value="False">
                                                        <Setter Property="Text" Value="Non"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                    </TextBlock>
                                </Border>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
                </DataGrid>
            </ScrollViewer>
        </Border>

        <!-- Actions Ã©lÃ©gantes (header fixe par-dessus) -->
        <Border Grid.Row="0" Background="White" CornerRadius="10" Padding="18" Margin="0,0,0,0"
                Panel.ZIndex="100">
            <Border.Effect>
                <DropShadowEffect Color="#E0E0E0" BlurRadius="10" ShadowDepth="2" Opacity="0.2" Direction="270"/>
            </Border.Effect>
            <StackPanel Orientation="Horizontal">
                <Button Click="BtnNouvelUtilisateur_Click"
                        Background="#00915A" Foreground="White" Padding="18,10" 
                        BorderThickness="0" Cursor="Hand" FontWeight="Bold" FontSize="13">
                    <Button.Style>
                        <Style TargetType="Button">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}" CornerRadius="8" Padding="{TemplateBinding Padding}">
                                            <Border.Effect>
                                                <DropShadowEffect Color="#00915A" BlurRadius="8" ShadowDepth="0" Opacity="0.3"/>
                                            </Border.Effect>
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="âž•" FontSize="14" Margin="0,0,6,0"/>
                                                <TextBlock Text="Nouvel utilisateur" FontSize="13" FontWeight="Bold"/>
                                            </StackPanel>
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </Button.Style>
                </Button>
                <Button Click="BtnModifierUtilisateur_Click" Margin="10,0,0,0"
                        Background="#1976D2" Foreground="White" Padding="18,10" 
                        BorderThickness="0" Cursor="Hand" FontWeight="Bold" FontSize="13">
                    <Button.Style>
                        <Style TargetType="Button">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}" CornerRadius="8" Padding="{TemplateBinding Padding}">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="âœï¸" FontSize="14" Margin="0,0,6,0"/>
                                                <TextBlock Text="Modifier" FontSize="13" FontWeight="Bold"/>
                                            </StackPanel>
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </Button.Style>
                </Button>
                <Button Click="BtnSupprimerUtilisateur_Click" Margin="10,0,0,0"
                        Background="#C62828" Foreground="White" Padding="18,10" 
                        BorderThickness="0" Cursor="Hand" FontWeight="Bold" FontSize="13">
                    <Button.Style>
                        <Style TargetType="Button">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}" CornerRadius="8" Padding="{TemplateBinding Padding}">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="ðŸ—‘ï¸" FontSize="14" Margin="0,0,6,0"/>
                                                <TextBlock Text="Supprimer" FontSize="13" FontWeight="Bold"/>
                                            </StackPanel>
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </Button.Style>
                </Button>
                <Button Click="BtnActualiser_Click" Margin="10,0,0,0"
                        Background="#F5F5F5" Foreground="#1A1919" Padding="18,10" 
                        BorderThickness="1" BorderBrush="#E0E0E0" Cursor="Hand" FontWeight="Bold" FontSize="13">
                    <Button.Style>
                        <Style TargetType="Button">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}" CornerRadius="8" Padding="{TemplateBinding Padding}"
                                                BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="ðŸ”„" FontSize="14" Margin="0,0,6,0"/>
                                                <TextBlock Text="Actualiser" FontSize="13" FontWeight="Bold"/>
                                            </StackPanel>
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </Button.Style>
                </Button>
            </StackPanel>
        </Border>

        <!-- Pagination -->
        <Border Grid.Row="2" Background="White" CornerRadius="10" Padding="15" Margin="0,10,0,0">
            <Border.Effect>
                <DropShadowEffect Color="#E0E0E0" BlurRadius="10" ShadowDepth="2" Opacity="0.2" Direction="270"/>
            </Border.Effect>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Info pagination -->
                <TextBlock Grid.Column="0" VerticalAlignment="Center" FontSize="13" Foreground="#666">
                    <Run Text="Affichage de "/>
                    <Run x:Name="TxtDebutPage" Text="1" FontWeight="Bold" Foreground="#1A1919"/>
                    <Run Text=" Ã  "/>
                    <Run x:Name="TxtFinPage" Text="25" FontWeight="Bold" Foreground="#1A1919"/>
                    <Run Text=" sur "/>
                    <Run x:Name="TxtTotalUtilisateurs" Text="0" FontWeight="Bold" Foreground="#1A1919"/>
                    <Run Text=" utilisateur(s)"/>
                </TextBlock>

                <!-- Navigation pagination -->
                <StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button x:Name="BtnPagePrecedente" Click="BtnPagePrecedente_Click"
                            Content="â—€ PrÃ©cÃ©dent" Padding="12,6" Margin="0,0,10,0"
                            Background="#F5F5F5" Foreground="#1A1919" BorderBrush="#E0E0E0" BorderThickness="1"
                            FontSize="12" FontWeight="SemiBold" Cursor="Hand">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="{TemplateBinding Background}" 
                                                    BorderBrush="{TemplateBinding BorderBrush}" 
                                                    BorderThickness="{TemplateBinding BorderThickness}"
                                                    CornerRadius="6" Padding="{TemplateBinding Padding}">
                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#E0E0E0"/>
                                    </Trigger>
                                    <Trigger Property="IsEnabled" Value="False">
                                        <Setter Property="Opacity" Value="0.5"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>

                    <TextBlock VerticalAlignment="Center" Margin="0,0,10,0" FontSize="12" Foreground="#666">
                        <Run Text="Page "/>
                        <Run x:Name="TxtNumeroPage" Text="1" FontWeight="Bold" Foreground="#1A1919"/>
                        <Run Text=" / "/>
                        <Run x:Name="TxtNombrePages" Text="1" FontWeight="Bold" Foreground="#1A1919"/>
                    </TextBlock>

                    <Button x:Name="BtnPageSuivante" Click="BtnPageSuivante_Click"
                            Content="Suivant â–¶" Padding="12,6"
                            Background="#1976D2" Foreground="White" BorderThickness="0"
                            FontSize="12" FontWeight="SemiBold" Cursor="Hand">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="{TemplateBinding Background}" CornerRadius="6" Padding="{TemplateBinding Padding}">
                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#1565C0"/>
                                    </Trigger>
                                    <Trigger Property="IsEnabled" Value="False">
                                        <Setter Property="Opacity" Value="0.5"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Page> 
                          IsReadOnly="True" CanUserAddRows="False" SelectionMode="Single"
                          HeadersVisibility="Column" GridLinesVisibility="None"
                          BorderThickness="0" RowHeight="50"
                          AlternatingRowBackground="#FAFAFA" RowBackground="White"
                          VerticalScrollBarVisibility="Disabled">
                <DataGrid.ColumnHeaderStyle>
                    <Style TargetType="DataGridColumnHeader">
                        <Setter Property="Background" Value="#F5F5F5"/>
                        <Setter Property="Foreground" Value="#1A1919"/>
                        <Setter Property="FontWeight" Value="Bold"/>
                        <Setter Property="FontSize" Value="13"/>
                        <Setter Property="Padding" Value="15,12"/>
                        <Setter Property="BorderThickness" Value="0,0,0,2"/>
                        <Setter Property="BorderBrush" Value="#E0E0E0"/>
                    </Style>
                </DataGrid.ColumnHeaderStyle>
                <DataGrid.CellStyle>
                    <Style TargetType="DataGridCell">
                        <Setter Property="BorderThickness" Value="0"/>
                        <Setter Property="Padding" Value="15,10"/>
                        <Setter Property="FontSize" Value="13"/>
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="DataGridCell">
                                    <Border Padding="{TemplateBinding Padding}" Background="{TemplateBinding Background}">
                                        <ContentPresenter VerticalAlignment="Center"/>
                                    </Border>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </DataGrid.CellStyle>
                <DataGrid.Columns>
                    <DataGridTextColumn Header="ðŸ‘¤ Nom complet" Binding="{Binding Nom}" Width="*" FontWeight="SemiBold"/>
                    <DataGridTextColumn Header="ðŸ’¼ Username Windows" Binding="{Binding UsernameWindows}" Width="*"/>
                    <DataGridTextColumn Header="ðŸŽ­ RÃ´le" Binding="{Binding RoleNom}" Width="180"/>
                    <DataGridTemplateColumn Header="ðŸ“Š Statut" Width="160">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Border x:Name="StatusBadge" CornerRadius="12" Padding="10,5" HorizontalAlignment="Center">
                                    <TextBlock x:Name="StatusText" FontWeight="Bold" FontSize="11" TextAlignment="Center"/>
                                </Border>
                                <DataTemplate.Triggers>
                                    <DataTrigger Binding="{Binding Statut}" Value="BAU">
                                        <Setter TargetName="StatusBadge" Property="Background" Value="#E3F2FD"/>
                                        <Setter TargetName="StatusText" Property="Foreground" Value="#1976D2"/>
                                        <Setter TargetName="StatusText" Property="Text" Value="ðŸ’¼ BAU"/>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding Statut}" Value="PROJECTS">
                                        <Setter TargetName="StatusBadge" Property="Background" Value="#F3E5F5"/>
                                        <Setter TargetName="StatusText" Property="Foreground" Value="#7B1FA2"/>
                                        <Setter TargetName="StatusText" Property="Text" Value="ðŸŽ¯ PROJECTS"/>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding Statut}" Value="Temporary">
                                        <Setter TargetName="StatusBadge" Property="Background" Value="#FFF3E0"/>
                                        <Setter TargetName="StatusText" Property="Foreground" Value="#F57C00"/>
                                        <Setter TargetName="StatusText" Property="Text" Value="â±ï¸ Temporary"/>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding Statut}" Value="Hiring ongoing">
                                        <Setter TargetName="StatusBadge" Property="Background" Value="#E8F5E9"/>
                                        <Setter TargetName="StatusText" Property="Foreground" Value="#388E3C"/>
                                        <Setter TargetName="StatusText" Property="Text" Value="ðŸ” Hiring ongoing"/>
                                    </DataTrigger>
                                </DataTemplate.Triggers>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <DataGridTemplateColumn Header="âœ… Actif" Width="120">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Border x:Name="ActiveBadge" CornerRadius="12" Padding="10,5" HorizontalAlignment="Center">
                                    <TextBlock x:Name="ActiveText" FontWeight="Bold" FontSize="11" TextAlignment="Center"/>
                                </Border>
                                <DataTemplate.Triggers>
                                    <DataTrigger Binding="{Binding Actif}" Value="True">
                                        <Setter TargetName="ActiveBadge" Property="Background" Value="#E8F5E9"/>
                                        <Setter TargetName="ActiveText" Property="Foreground" Value="#00915A"/>
                                        <Setter TargetName="ActiveText" Property="Text" Value="âœ… Actif"/>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding Actif}" Value="False">
                                        <Setter TargetName="ActiveBadge" Property="Background" Value="#FFEBEE"/>
                                        <Setter TargetName="ActiveText" Property="Foreground" Value="#C62828"/>
                                        <Setter TargetName="ActiveText" Property="Text" Value="âŒ Inactif"/>
                                    </DataTrigger>
                                </DataTemplate.Triggers>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
                </DataGrid>
            </ScrollViewer>
        </Border>
        
        <!-- Pagination -->
        <Border Grid.Row="2" Background="White" CornerRadius="10" Padding="15" Margin="0,15,0,0">
            <Border.Effect>
                <DropShadowEffect Color="#E0E0E0" BlurRadius="10" ShadowDepth="2" Opacity="0.2" Direction="270"/>
            </Border.Effect>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <!-- Info pagination -->
                <TextBlock Grid.Column="0" VerticalAlignment="Center" FontSize="13" Foreground="#666">
                    <Run Text="Affichage de "/>
                    <Run x:Name="TxtDebutPage" Text="1" FontWeight="Bold"/>
                    <Run Text=" Ã  "/>
                    <Run x:Name="TxtFinPage" Text="25" FontWeight="Bold"/>
                    <Run Text=" sur "/>
                    <Run x:Name="TxtTotalUtilisateurs" Text="0" FontWeight="Bold"/>
                    <Run Text=" utilisateur(s)"/>
                </TextBlock>
                
                <!-- Boutons navigation -->
                <StackPanel Grid.Column="2" Orientation="Horizontal">
                    <Button x:Name="BtnPagePrecedente" Click="BtnPagePrecedente_Click" 
                            Background="#F5F5F5" Foreground="#1A1919" Padding="12,8" 
                            BorderThickness="1" BorderBrush="#E0E0E0" Cursor="Hand" 
                            FontWeight="Bold" FontSize="12" Margin="0,0,8,0">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="{TemplateBinding Background}" 
                                                    CornerRadius="6" Padding="{TemplateBinding Padding}"
                                                    BorderBrush="{TemplateBinding BorderBrush}" 
                                                    BorderThickness="{TemplateBinding BorderThickness}">
                                                <TextBlock Text="â—€ PrÃ©cÃ©dent" FontSize="12" FontWeight="Bold"/>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <Trigger Property="IsEnabled" Value="False">
                                        <Setter Property="Opacity" Value="0.5"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>
                    
                    <TextBlock x:Name="TxtPageActuelle" VerticalAlignment="Center" 
                               FontSize="13" FontWeight="Bold" Margin="8,0"
                               Foreground="#1A1919">
                        <Run Text="Page "/>
                        <Run x:Name="TxtNumeroPage" Text="1"/>
                        <Run Text=" / "/>
                        <Run x:Name="TxtNombrePages" Text="1"/>
                    </TextBlock>
                    
                    <Button x:Name="BtnPageSuivante" Click="BtnPageSuivante_Click" 
                            Background="#F5F5F5" Foreground="#1A1919" Padding="12,8" 
                            BorderThickness="1" BorderBrush="#E0E0E0" Cursor="Hand" 
                            FontWeight="Bold" FontSize="12" Margin="8,0,0,0">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="{TemplateBinding Background}" 
                                                    CornerRadius="6" Padding="{TemplateBinding Padding}"
                                                    BorderBrush="{TemplateBinding BorderBrush}" 
                                                    BorderThickness="{TemplateBinding BorderThickness}">
                                                <TextBlock Text="Suivant â–¶" FontSize="12" FontWeight="Bold"/>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <Trigger Property="IsEnabled" Value="False">
                                        <Setter Property="Opacity" Value="0.5"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Page>
